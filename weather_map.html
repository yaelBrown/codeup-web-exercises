<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required Meta Tags -->
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="keywords" content="">
    <meta name="author" content="Yael Brown">
    <meta name="copyright" content="">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Nanum+Pen+Script&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

    <!-- Mapbox GL JS -->
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.css' rel='stylesheet' />

    <title>Weather Map API project </title>

    <!-- Style -->
    <style>
      /* Variables */

      :root {
        --null: "";
      }

      /* Borders (for troubleshooting) */

      .wborder {
        border: 1px solid #fff;
        z-index: 999;
      }

      .bborder {
        border: 1px solid #000;
        z-index: 999;
      }

      /* Basic Page Elements */

      * {
        box-sizing: border-box;
      }

      main, html, body {
        width: 100%;
        height: 100%;
        padding: 0px;
        margin: 0px;
      }

      body{
        background-color: #3e4149;
      }

      /* Page Content */ 

      .app {
        background: #efefef;
        margin: 1em;
        border-radius: 15px;
        display: flex;
        justify-content: center;
        flex-direction: column;
        align-items: center;
      }

      .header {
        font-family: 'Nanum Pen Script', cursive;
        height: 300px;
        background-color: #8c9184;
        background: url('/img/jacket-dude.gif');
        background-size: cover;
        width: 100%;
        display: flex;
        justify-content: center;
        flex-direction: column;
        align-items: center;
        border-radius: 15px 15px 0px 0px;
        color: #000;
      }

      .header > h1 {
        font-size: 9em;
      }

      .header > p {
        font-family: Arial, Helvetica, sans-serif;
        font-weight: 200;
        font-size: .8em;
      }

      .header > h1, 
      .header > p {
        background-color: rgba(255,255,255,.3);
        border-radius: 10px;
        padding: 10px;
      }

      input {
        border: none;
        width: 40%;
      }

      #input-city {
        width: 400px;
        text-align: center;
        background-color: #efefef;
        color: #000;
        user-select: none;
        margin-bottom: 1em;
        margin-top: 1em;
      }

      #showWeather {
        display: none;
      }

      .cityNameDiv {
        height: 5em;
      }

      #cityName {
        font-family: 'Nanum Pen Script', cursive;
        font-size: 3.5em;
      }

      #map {
        width: 90%; 
        height: 250px;
        margin-bottom: 1em;
        border-radius: 10px;
        box-shadow: 2px 10px 10px 1px rgba(0,0,0,0.75);
      }

      .card {
        margin: 1em auto;
        width: 100px;
      }

      .card-body {
        text-align: center;
      }
    
      #fly {
        display: none;
        position: relative;
        margin: 0px auto;
        width: 50%;
        height: 40px;
        padding: 10px;
        border: none;
        border-radius: 3px;
        font-size: 12px;
        text-align: center;
        color: #fff;
        background: #ee8a65;
        cursor: pointer;
      }

      .threeDay {
        display: flex;
        flex-direction: row;
        align-content: center;
        justify-content: center;
        width: 80%;
        padding-top: 2em;
      }

      .threeDay h4 {
        width: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        align-self: center;
        padding: 0;
        padding-top: 0.5em;
        text-align: center;
        font-family: 'Nanum Pen Script', cursive;
        font-size: 2em;
      }

    </style>
  </head>






  <body>
    <div class="container">
      <div class="app">
        <div class="header">
          <h1>weatherly</h1>
          <p>(my attempt of a cheese startup name)</p> 
        </div>

        <!-- City input -->
        <input type="text" id="input-city" name="input-city" placeholder="City" tabindex="1" class="form-control no-border">
      
        <div id="showWeather"></div>
        <!-- Name of city -->
        <div class="cityNameDiv">
          <h1 id="cityName"></h1>
          <div id="weatherIcon"></div>
        </div>
        <div id="fly">Fly</div>
        
        <!-- mapBox boilerplate -->
        <div id='map'></div>
        
        <div class="threeDay">
          <img src="img/amcharts_weather_icons_1.0.0/animated/weather.svg">
          <h4 class="">Three Day Forecast </h4>
          <img src="img/amcharts_weather_icons_1.0.0/animated/weather.svg">
        </div>

        <!-- Weather Cards -->
        <div class="card" style="width: 18rem;">
          <div class="card-body">
            <h5 class="card-title" id="summary"></h5>
            <h6 class="card-subtitle mb-2 text-muted" >Card subtitle</h6>
            <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
          </div>
        </div>
      </div>
      
      
    </div>












    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="js/jquery-2.2.4.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <!-- Load Key -->
    <script src="js/keys.js"></script>

    <!-- mapbox utils -->
    <script src="./js/mapbox-utils.js"></script>

    <script>
      'use strict';
      // Declare Variables
      var show = document.getElementById("showWeather");
      var inputCity = document.getElementById("input-city");
      var cityNameDiv = document.getElementById("cityName");
      var city = "";
      var cityCoords; 
      var browserLocation = [];
      var loc;
      var proxy = 'https://cors-anywhere.herokuapp.com/';
      var darkSky = 'https://api.darksky.net/forecast/';
      var long = Number.MIN_SAFE_INTEGER;
      var lat = Number.MIN_SAFE_INTEGER;
      var currentDarkSkyData;


      show.innerHTML = "this is working";

      // On [enter] keypress take input from input-city
      // keyDown
      document.addEventListener("keydown", function(e) {
        e.preventDefault;
        if (e.keyCode === 13) {
          console.log(inputCity.value);
          cityNameDiv.innerText = inputCity.value;
          city = inputCity.value;
          geocode(city, mapBoxToken).then(function(result) {
            cityCoords = result;
          });
        }
      });

      // keyUp
      document.addEventListener("keyup", function(e) {
        e.preventDefault;
        if (e.keyCode === 13) {
          flyMe(cityCoords[0], cityCoords[1]);
        }
      });

      // ===== Browser Navigator =====
      // Get browser location
      function getLocation() {   // this function will show current location
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
          flyMe(currentDarkSkyData.longitude, currentDarkSkyData.latitude);
        } else {
          x.innerHTML = "Geolocation is not supported by this browser.";
        }
      }

      function showPosition(position) {
        show.innerHTML = "Latitude: " + position.coords.latitude + 
        "<br>Longitude: " + position.coords.longitude; 
        loc = position.coords.latitude + "," + position.coords.longitude;
        return loc;
      }

      // After 5 seconds, get browser location
      // setTimeout(getLocation(), 8000);

      $.get(proxy + darkSky + darkSkyKey + "/29.4267,-98.4896").done(function(data) {
        console.log(data);
        currentDarkSkyData = data;
        show.innerText = data.currently.apparentTemperature + " F";
      }).fail(function(jqXhr, status) {
        console.log(status);
      });

      // conversion formulas
      function convertFtoC(num) {
        return (num - 32) / 1.8;
      }

      function convertCtoF(num) {
        return (num * 1.8) + 32;
      }
      
      
      
      
      
      
      // ===== mapBox =====
      // Basic specs for map
      mapboxgl.accessToken = mapBoxToken;
      var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v9',
        zoom: 0
      });

      // Fly to location when 'Fly' button is pressed
      document.getElementById("fly").addEventListener("click", function() {
        console.log("fly was pressed")
        map.flyTo({
          center: [
            -74.50 + (Math.random() - 0.5) * 10,
            40 + (Math.random() - 0.5) * 10],
          zoom: 18
        });
      })
      
      // function to fly somewhere.
      function flyMe(argsLong, argsLat) {
        map.flyTo({
          center: [argsLong, argsLat],
          zoom: 10
        });
      }

      

      // ===== Weather Icon =====
      function selectWeatherIcon(str) {
        let icon; 
        let dir = "/img/amcharts_weather_icons_1.0.0/animated/"

        switch (str) {
          case "clear-day":
            icon = dir + "day.svg";
            break;
          case "clear-night":
            icon = dir + "night.svg";
            break;
          case "rain":
            icon = dir + "rainy-4.svg";
            break;
          case "snow":
            icon = dir + "snowy-5.svg";
            break;
          case "sleet":
            icon = dir + "snowy-4.svg";
            break;
          case "cloudy":
          case "fog":
          case "wind":
            icon = dir + "cloudy-night-3.svg";
            break;
          case "hail":
            icon = dir + "rainy-7.svg";
            break;
          case "tornado":
          case "thunderstorm":
            icon = dir + "thunder.svg";
            break;
          case "partly-cloudy-day":
            icon = dir + "cloudy-day-1.svg";
            break;
          case "partly-cloudy-night":
            icon = dir + "cloudy-night-2.svg";
            break;
          default: 
            icon = dir + "day.svg";
            break;
        }

        return icon;
      }

    // Handle Card data
    function manageCardData(obj) {
      



    }






    </script>








  </body>
</html>